<!DOCTYPE html>
<html>
<head>
    <title>Streaming Hub</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <style>
        body {
            background-color: rgb(50, 50, 50);
            margin: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
            color: white;
            text-align: center;
        }
        .live {
            color: #32CD32;
            box-shadow: 0 0 10px #32CD32, 0 0 10px #32CD32, 0 0 40px #32CD32, 0 0 10px #52D017 inset;
            transform: scale(1.05);
        }
        .not-live {
            background-color: red;
        }
        .active {
            background-color: yellow;
        }
        .status-button {
    margin-right: 5px;
    margin-bottom: 5px;
    padding: 8px 12px;
    border-radius: 5px;
    cursor: pointer;
}

 #top-bar {
    display: flex;
    align-items: center;
    justify-content: space-between; /* 左右對齊 */
    gap: 10px;
    flex-wrap: wrap;
    padding: 10px;
}

#lists {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 5px;
    flex-grow: 1; /* 讓按鈕區域可自適應 */
}

#input-container {
    display: flex;
    align-items: center;
    gap: 5px;
    white-space: nowrap; /* 防止輸入框和按鈕換行 */
}

        .content {
            display: flex;
            flex: 1;
            flex-direction: column;
            height: 100%;
        }
        .video, .chat {
            border: none;
        }
        .video {
            height: 30vh;
            width: 100%;
        }
        .chat {
            height: 70vh;
            width: 100%;
        }
        input {
            padding: 5px;
            margin-right: 5px;
        }
        button {
            padding: 5px 10px;
            cursor: pointer;
        }
        @media (min-width: 768px) {
            .content {
                flex-direction: row;
            }
            .video {
                height: 100%;
                width: 70%;
            }
            .chat {
                height: 100%;
                width: 30%;
            }
        }
    </style>
</head>
<body>

<script>
    const channels = [
        { id: 'ww291603', type: 'kick', name: 'Ⓚ翼' },
		{ id: 'ww291603', type: 'twitch', name: 'Ⓣ翼' },
		{ id: '9013975129715', type: 'ok', name: 'ⓞ翼' },
        { id: 'Eastsnake25', type: 'kick', name: 'ⓀN' },
        { id: 'alancml', type: 'twitch', name: 'ⓉA' },
        { id: 'collartv', type: 'kick', name: 'ⓀA' },
        { id: 'nanase-maru525', type: 'kick', name: 'Ⓚ西' },
        { id: 'jeukpo', type: 'kick', name: 'Ⓚ爵' },
        { id: 'mingpig930_2', type: 'twitch', name: 'Ⓣ朗' },
        { id: 'qt369', type: 'kick', name: 'ⓀQT' },
        { id: 'cobra2024', type: 'kick', name: '哥' },
        { id: 'yaubotai2', type: 'twitch', name: 'Ⓣ友' },
        
        { id: '3849262800563', type: 'ok', name: 'ⓞQT' }
    ];

    function getChannelUrl(channel) {
        if (channel.type === 'kick') {
            return `https://player.kick.com/${channel.id}`;
        } else if (channel.type === 'twitch') {
            return `https://player.twitch.tv/?channel=${channel.id}&parent=chicktv.github.io&parent=chicktv.github.io`;
        } else if (channel.type === 'ok') {
            return `https://ok.ru/videoembed/${channel.id}?nochat=1&autoplay=1`;
        }
        return '';
    }

    function changeSrc(loc, clickedButton = null) {
        document.getElementById('MyFrame').src = loc;

        // 清除所有按鈕的 active 樣式
        document.querySelectorAll('.status-button').forEach(button => {
            button.classList.remove('active');
        });

        // 只有在點擊按鈕時才高亮
        if (clickedButton) {
            clickedButton.classList.add('active');
        }
    }

    function generateButtons() {
        const listsDiv = document.getElementById('lists');
        listsDiv.innerHTML = '';

        channels.forEach(channel => {
            const button = document.createElement('button');
            button.id = channel.id;
            button.className = 'status-button';
            button.textContent = channel.name;
            button.onclick = () => changeSrc(getChannelUrl(channel), button);
            listsDiv.appendChild(button);
        });
		
    }

    function clickyClick() {
        const inputField = document.getElementById('newid');
        const userInput = inputField.value.trim();

        if (!userInput) {
            alert("請輸入 Twitch ID 或 Kick ID（Kick 的話請在前面加 [k]）");
            return;
        }

        let streamUrl = "";
        if (userInput.startsWith("[k]")) {
            const kickId = userInput.replace("[k]", "");
            streamUrl = `https://player.kick.com/${kickId}`;
        } else {
            streamUrl = `https://player.twitch.tv/?channel=${userInput}&parent=chicktv.github.io&parent=chicktv.github.io`;
        }

        changeSrc(streamUrl);
    }

    function fetchStatus(channel) {
        const statusElement = document.getElementById(channel.id);
        const url = channel.type === 'kick' 
            ? `https://kick.com/api/v2/channels/${channel.id}` 
            : `https://twitch-proxy.freecodecamp.rocks/helix/streams?user_login=${channel.id}`;

        fetch(url)
            .then(response => response.json())
            .then(data => {
                const isLive = channel.type === 'kick' 
                    ? data?.livestream?.is_live ?? false 
                    : data?.data?.length > 0;

                if (isLive) {
                    statusElement.classList.add('live');
                    statusElement.classList.remove('not-live');
                } else {
                    statusElement.classList.add('not-live');
                    statusElement.classList.remove('live');
                }
            })
            .catch(error => {
                console.error(`Error fetching status for ${channel.id}:`, error);
                statusElement.classList.add('not-live');
                statusElement.classList.remove('live');
            });
    }

    function fetchAllStatuses() {
        channels.forEach(fetchStatus);
    }

    document.addEventListener('DOMContentLoaded', () => {
        generateButtons();
        fetchAllStatuses();
        setInterval(fetchAllStatuses, 8 * 60 * 1000);
    });

</script>

<div id="top-bar">
    <div id="lists"></div>
    <div id="input-container">
        <input type="text" id="newid" placeholder="twitch id / k台 id 前加 [k]" />
        <button onclick="clickyClick()">Submit</button>
		<button onclick="changechatSrc('https://sk-knower.com/chat/whitewing940920?pop=true')">SKchat</button>
    <button onclick="changechatSrc('https://www.twitch.tv/embed/whitewing940920/chat?darkpopout&parent=chicktv.github.io')">Tchat</button>
    </div>
</div>

<div class="content">
    <iframe id="MyFrame" class="video" src="https://ok.ru/videoembed/9013975129715?nochat=1&autoplay=1" frameborder="0" allowfullscreen></iframe>
    <iframe class="chat" id="chat_embed" src="https://www.twitch.tv/embed/Whitewing940920/chat?darkpopout&parent=chicktv.github.io"></iframe>
</div>

</body>
</html>
